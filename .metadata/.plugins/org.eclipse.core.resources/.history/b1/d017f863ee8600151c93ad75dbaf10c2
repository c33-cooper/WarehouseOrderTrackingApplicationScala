import java.sql.Statement
import java.sql.ResultSet
import java.sql.Connection

/**
 * @author callum
 */
class Order {
  
  // Attributes
  var orderSelector : String = _
  var orderID : String = _
  var orderDateCreated : String = _
  var orderVerified : Boolean = _
  var orderTotals : Double = _
  var productQuantity : Int = _
  var orderStatus : String = _
  
   /**
   * Establish the orders table
   */
  def establishOrdersFromDatabase {
     
     // Establish the orders
     try{
           // Create the sql attributes
           val dbConnection = new Database()
           val connection : Connection = dbConnection connect()
           
           // SQL attributes
           //Creates the statement and runs the select query
            val statement = connection createStatement()
            val rs = statement executeQuery("""SELECT idorders, orderDateCreated,
           orderVerified, orderTotal, productQuantity, orderStatus 
           FROM orders""")
           
           // Loop through database elements
           while (rs next) {
             
             // Store database elements into attributes
              orderID = rs.getString("idorders")
              orderDateCreated = rs.getString("orderDateCreated")
              orderVerified = rs.getBoolean("orderVerified")
              orderTotals= rs.getDouble("orderTotal")
              productQuantity = rs.getInt("productQuantity")
              orderStatus = rs.getString("orderStatus")
              
              // Print orders
              println("Order ID: " + orderID
                      + "\nOrder Date Created: " + orderDateCreated
                      + "\nOrder Verified: " + orderVerified
                      + "\nOrder Total: " + orderTotals + " GBP"
                      + "\nProduct Quantity: " + productQuantity 
                      + "\nOrder Status: " + orderStatus + "\n")
           }
           // Close the connection
           rs close
     }
      catch {
        case e => e.printStackTrace
      }
   }
  
}